<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="web.mvc.common.dao.CM002Dao">
    <select id="get" resultType="int">
        select count(*) from tbl_user_info
        <where>
            <if test="userId != null">
                user_id = #{userId}
            </if>
            <if test="nickName != null">
                user_nickname = #{nickName}
            </if>
        </where>
    </select>

    <select id="getNick" resultType="int">
        select count(*) from tbl_user_info
    </select>



    <insert id="save">
        <selectKey resultType="long" keyProperty="userSeq" order="BEFORE">
            select MAX(user_seq)+1 from tbl_user_info
        </selectKey>
        insert into tbl_user_info(
            user_seq,
            user_id,
            user_nm,
            user_pwd,
            user_role,
            user_nickname,
            email,
            reg_date
        ) values(
            #{userSeq},
            #{userId},
            #{userNm},
            #{encPwd},
            #{userRole},
            #{email},
            #{email},
            to_char(now(), 'YYYYMMDDHH24MISS')
        )
    </insert>

</mapper>